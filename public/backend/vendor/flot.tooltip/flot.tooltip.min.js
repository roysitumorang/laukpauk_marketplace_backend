!function(e){var t={tooltip:{show:!1,cssClass:"flotTip",content:"%s | X: %x | Y: %y",xDateFormat:null,yDateFormat:null,monthNames:null,dayNames:null,shifts:{x:10,y:20},defaultTheme:!0,lines:!1,onHover:function(){},$compat:!1}};t.tooltipOpts=t.tooltip;var n=function(e){this.tipPosition={x:0,y:0},this.init(e)};n.prototype.init=function(t){function n(e){var n={};n.x=e.pageX,n.y=e.pageY,t.setTooltipPosition(n)}function i(n,i,r){var s=function(e,t,n,i){return Math.sqrt((n-e)*(n-e)+(i-t)*(i-t))},a=function(e,t,n,i,o,r,a){if(a&&(a=function(e,t,n,i,o,r){if(void 0!==n)return{x:n,y:t};if(void 0!==i)return{x:e,y:i};var s,a=-1/((r-i)/(o-n));return{x:s=(o*(e*a-t+i)+n*(e*-a+t-r))/(a*(o-n)+i-r),y:a*s-a*e+t}}(e,t,n,i,o,r),!!(a.x<Math.min(n,o)||a.x>Math.max(n,o)||a.y<Math.min(i,r)||a.y>Math.max(i,r)))){var l=s(e,t,n,i),c=s(e,t,o,r);return l>c?c:l}var u=i-r,p=o-n,d=n*r-i*o;return Math.abs(u*e+p*t+d)/Math.sqrt(u*u+p*p)};if(r)t.showTooltip(r,i);else if(o.plotOptions.series.lines.show&&o.tooltipOptions.lines===!0){var l=o.plotOptions.grid.mouseActiveRadius,c={distance:l+1};e.each(t.getData(),function(e,n){for(var o=0,r=-1,l=1;l<n.data.length;l++)n.data[l-1][0]>i.x||n.data[l][0]<i.x||(o=l-1,r=l);if(-1===r)return void t.hideTooltip();var u={x:n.data[o][0],y:n.data[o][1]},p={x:n.data[r][0],y:n.data[r][1]},d=a(n.xaxis.p2c(i.x),n.yaxis.p2c(i.y),n.xaxis.p2c(u.x),n.yaxis.p2c(u.y),n.xaxis.p2c(p.x),n.yaxis.p2c(p.y),!1);if(d<c.distance){var h=s(u.x,u.y,i.x,i.y)<s(i.x,i.y,p.x,p.y)?o:r,f=(n.datapoints.pointsize,[i.x,u.y+(p.y-u.y)*((i.x-u.x)/(p.x-u.x))]),m={datapoint:f,dataIndex:h,series:n,seriesIndex:e};c={distance:d,item:m}}}),c.distance<l+1?t.showTooltip(c.item,i):t.hideTooltip()}else t.hideTooltip()}var o=this,r=e.plot.plugins.length;if(this.plotPlugins=[],r)for(var s=0;r>s;s++)this.plotPlugins.push(e.plot.plugins[s].name);t.hooks.bindEvents.push(function(t,r){if(o.plotOptions=t.getOptions(),"boolean"==typeof o.plotOptions.tooltip&&(o.plotOptions.tooltipOpts.show=o.plotOptions.tooltip,o.plotOptions.tooltip=o.plotOptions.tooltipOpts,delete o.plotOptions.tooltipOpts),o.plotOptions.tooltip.show!==!1&&void 0!==o.plotOptions.tooltip.show){o.tooltipOptions=o.plotOptions.tooltip,o.tooltipOptions.$compat?(o.wfunc="width",o.hfunc="height"):(o.wfunc="innerWidth",o.hfunc="innerHeight");o.getDomElement();e(t.getPlaceholder()).bind("plothover",i),e(r).bind("mousemove",n)}}),t.hooks.shutdown.push(function(t,o){e(t.getPlaceholder()).unbind("plothover",i),e(o).unbind("mousemove",n)}),t.setTooltipPosition=function(t){var n=o.getDomElement(),i=n.outerWidth()+o.tooltipOptions.shifts.x,r=n.outerHeight()+o.tooltipOptions.shifts.y;t.x-e(window).scrollLeft()>e(window)[o.wfunc]()-i&&(t.x-=i),t.y-e(window).scrollTop()>e(window)[o.hfunc]()-r&&(t.y-=r),o.tipPosition.x=t.x,o.tipPosition.y=t.y},t.showTooltip=function(e,n){var i=o.getDomElement(),r=o.stringFormat(o.tooltipOptions.content,e);""!==r&&(i.html(r),t.setTooltipPosition({x:n.pageX,y:n.pageY}),i.css({left:o.tipPosition.x+o.tooltipOptions.shifts.x,top:o.tipPosition.y+o.tooltipOptions.shifts.y}).show(),"function"==typeof o.tooltipOptions.onHover&&o.tooltipOptions.onHover(e,i))},t.hideTooltip=function(){o.getDomElement().hide().html("")}},n.prototype.getDomElement=function(){var t=e("."+this.tooltipOptions.cssClass);return 0===t.length&&(t=e("<div />").addClass(this.tooltipOptions.cssClass),t.appendTo("body").hide().css({position:"absolute"}),this.tooltipOptions.defaultTheme&&t.css({background:"#fff","z-index":"1040",padding:"0.4em 0.6em","border-radius":"0.5em","font-size":"0.8em",border:"1px solid #111",display:"none","white-space":"nowrap"})),t},n.prototype.stringFormat=function(e,t){var n,i,o,r,s=/%p\.{0,1}(\d{0,})/,a=/%s/,l=/%c/,c=/%lx/,u=/%ly/,p=/%x\.{0,1}(\d{0,})/,d=/%y\.{0,1}(\d{0,})/,h="%x",f="%y",m="%ct";if(void 0!==t.series.threshold?(n=t.datapoint[0],i=t.datapoint[1],o=t.datapoint[2]):void 0!==t.series.lines&&t.series.lines.steps?(n=t.series.datapoints.points[2*t.dataIndex],i=t.series.datapoints.points[2*t.dataIndex+1],o=""):(n=t.series.data[t.dataIndex][0],i=t.series.data[t.dataIndex][1],o=t.series.data[t.dataIndex][2]),null===t.series.label&&t.series.originSeries&&(t.series.label=t.series.originSeries.label),"function"==typeof e&&(e=e(t.series.label,n,i,t)),"boolean"==typeof e&&!e)return"";if(void 0!==t.series.percent?r=t.series.percent:void 0!==t.series.percents&&(r=t.series.percents[t.dataIndex]),"number"==typeof r&&(e=this.adjustValPrecision(s,e,r)),e=void 0!==t.series.label?e.replace(a,t.series.label):e.replace(a,""),e=void 0!==t.series.color?e.replace(l,t.series.color):e.replace(l,""),e=this.hasAxisLabel("xaxis",t)?e.replace(c,t.series.xaxis.options.axisLabel):e.replace(c,""),e=this.hasAxisLabel("yaxis",t)?e.replace(u,t.series.yaxis.options.axisLabel):e.replace(u,""),this.isTimeMode("xaxis",t)&&this.isXDateFormat(t)&&(e=e.replace(p,this.timestampToDate(n,this.tooltipOptions.xDateFormat,t.series.xaxis.options))),this.isTimeMode("yaxis",t)&&this.isYDateFormat(t)&&(e=e.replace(d,this.timestampToDate(i,this.tooltipOptions.yDateFormat,t.series.yaxis.options))),"number"==typeof n&&(e=this.adjustValPrecision(p,e,n)),"number"==typeof i&&(e=this.adjustValPrecision(d,e,i)),void 0!==t.series.xaxis.ticks){var g;g=this.hasRotatedXAxisTicks(t)?"rotatedTicks":"ticks";var v=t.dataIndex+t.seriesIndex;for(var y in t.series.xaxis[g])if(t.series.xaxis[g].hasOwnProperty(v)&&!this.isTimeMode("xaxis",t)){var x=this.isCategoriesMode("xaxis",t)?t.series.xaxis[g][v].label:t.series.xaxis[g][v].v;x===n&&(e=e.replace(p,t.series.xaxis[g][v].label))}}if(void 0!==t.series.yaxis.ticks)for(var y in t.series.yaxis.ticks)if(t.series.yaxis.ticks.hasOwnProperty(y)){var b=this.isCategoriesMode("yaxis",t)?t.series.yaxis.ticks[y].label:t.series.yaxis.ticks[y].v;b===i&&(e=e.replace(d,t.series.yaxis.ticks[y].label))}return void 0!==t.series.xaxis.tickFormatter&&(e=e.replace(h,t.series.xaxis.tickFormatter(n,t.series.xaxis).replace(/\$/g,"$$"))),void 0!==t.series.yaxis.tickFormatter&&(e=e.replace(f,t.series.yaxis.tickFormatter(i,t.series.yaxis).replace(/\$/g,"$$"))),o&&(e=e.replace(m,o)),e},n.prototype.isTimeMode=function(e,t){return void 0!==t.series[e].options.mode&&"time"===t.series[e].options.mode},n.prototype.isXDateFormat=function(){return void 0!==this.tooltipOptions.xDateFormat&&null!==this.tooltipOptions.xDateFormat},n.prototype.isYDateFormat=function(){return void 0!==this.tooltipOptions.yDateFormat&&null!==this.tooltipOptions.yDateFormat},n.prototype.isCategoriesMode=function(e,t){return void 0!==t.series[e].options.mode&&"categories"===t.series[e].options.mode},n.prototype.timestampToDate=function(t,n,i){var o=e.plot.dateGenerator(t,i);return e.plot.formatDate(o,n,this.tooltipOptions.monthNames,this.tooltipOptions.dayNames)},n.prototype.adjustValPrecision=function(e,t,n){var i,o=t.match(e);return null!==o&&""!==RegExp.$1&&(i=RegExp.$1,n=n.toFixed(i),t=t.replace(e,n)),t},n.prototype.hasAxisLabel=function(t,n){return-1!==e.inArray(this.plotPlugins,"axisLabels")&&void 0!==n.series[t].options.axisLabel&&n.series[t].options.axisLabel.length>0},n.prototype.hasRotatedXAxisTicks=function(t){return-1!==e.inArray(this.plotPlugins,"tickRotor")&&void 0!==t.series.xaxis.rotatedTicks};var i=function(e){new n(e)};e.plot.plugins.push({init:i,options:t,name:"tooltip",version:"0.8.5"})}(jQuery);
